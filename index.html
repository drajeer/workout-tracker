<!DOCTYPE html>
<html>
<head>
  <title>Google Auth Test</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script async defer src="https://accounts.google.com/gsi/client"></script>
  <script async defer src="https://apis.google.com/js/api.js"></script>
</head>
<body class="bg-slate-900 text-white flex items-center justify-center min-h-screen">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;
    const CLIENT_ID = '993686805304-ejcjgvg9or29fi8e7gsek1kqljob2hok.apps.googleusercontent.com';

    function TestApp() {
      const [status, setStatus] = useState("Waiting for Google Libraries...");
      const [isReady, setIsReady] = useState(false);

      useEffect(() => {
        // The Safety Gate: Poll for the google object
        const timer = setInterval(() => {
          if (window.google && window.google.accounts) {
            clearInterval(timer);
            setStatus("Google Libraries Loaded! âœ…");
            setIsReady(true);
          }
        }, 100);
        return () => clearInterval(timer);
      }, []);

      const handleTestLogin = () => {
        const client = google.accounts.oauth2.initTokenClient({
          client_id: CLIENT_ID,
          scope: 'https://www.googleapis.com/auth/drive.file',
          callback: (resp) => {
            if (resp.access_token) setStatus("Login Successful! Access Token Acquired. ðŸŽ‰");
          },
        });
        client.requestAccessToken();
      };

      return (
        <div className="bg-slate-800 p-8 rounded-2xl border border-slate-700 text-center max-w-sm">
          <h1 className="text-xl font-bold mb-4">Connection Tester</h1>
          <p className="text-slate-400 mb-6 text-sm">{status}</p>
          <button 
            disabled={!isReady}
            onClick={handleTestLogin}
            className={`w-full py-3 rounded-xl font-bold transition-all ${isReady ? 'bg-blue-600 hover:bg-blue-500' : 'bg-slate-700 text-slate-500 cursor-not-allowed'}`}
          >
            {isReady ? "Test Sign-In" : "Loading..."}
          </button>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<TestApp />);
  </script>
</body>
</html>
